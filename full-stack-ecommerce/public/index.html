<!-- public/index.html -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ShopFlow Internal Dashboard</title>
    <style>
        body { font-family: sans-serif; padding: 2rem; }
        .error { color: red; }
        .success { color: green; }
    </style>
</head>
<body>
    <h1>ShopFlow Dev Console</h1>
    
    <!-- TICKET 3.1: Connect this form to /api/auth/register -->
    <div id="auth-section">
        <h2>Admin Registration</h2>
        <input type="text" id="username" placeholder="Username" />
        <input type="password" id="password" placeholder="Password" />
        <button onclick="register()">Register</button>
        <p id="message"></p>
    </div>

    <!-- TICKET 4.2: Wishlist Display (Initially Hidden) -->
    <div id="wishlist-section" style="display:none; margin-top: 20px;">
        <h2>My Wishlist</h2>
        <ul id="wishlist-items"></ul>
    </div>

    <script>
        const API_URL = 'http://localhost:5000/api';

        async function register() {
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            const msg = document.getElementById('message');

            try {
                // STUDENT TASK: Fix the fetch call to handle CORS and JSON headers
                const res = await fetch(`${API_URL}/auth/register`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ username, password })
                });
                
                const data = await res.json();
                
                if (res.status === 201) {
                    msg.className = 'success';
                    msg.innerText = 'Success: ' + data.message;
                    document.getElementById('wishlist-section').style.display = 'block';
                } else {
                    msg.className = 'error';
                    msg.innerText = 'Error: ' + data.error;
                }
            } catch (e) {
                msg.innerText = 'Network Error: Is the server running?';
            }
        }
    </script>
</body>
</html>
